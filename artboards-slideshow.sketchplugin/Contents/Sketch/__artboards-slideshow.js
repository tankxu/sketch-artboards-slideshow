var globalThis=this,global=this;function __skpm_run(e,t){globalThis.context=t;try{var n=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t){e.exports=require("sketch")},function(e,t,n){var r=n(2).Buffer,a=n(3),i=a.parseStat,o=a.fsError,s=a.fsErrorForPath,l=a.encodingFromOptions,c=a.NOT_IMPLEMENTED;e.exports.constants={F_OK:0,R_OK:4,W_OK:2,X_OK:1},e.exports.access=c("access"),e.exports.accessSync=function(t,n){n|=0;var r=NSFileManager.defaultManager();switch(n){case 0:canAccess=e.exports.existsSync(t);break;case 1:canAccess=Boolean(Number(r.isExecutableFileAtPath(t)));break;case 2:canAccess=Boolean(Number(r.isWritableFileAtPath(t)));break;case 3:canAccess=Boolean(Number(r.isExecutableFileAtPath(t)))&&Boolean(Number(r.isWritableFileAtPath(t)));break;case 4:canAccess=Boolean(Number(r.isReadableFileAtPath(t)));break;case 5:canAccess=Boolean(Number(r.isReadableFileAtPath(t)))&&Boolean(Number(r.isExecutableFileAtPath(t)));break;case 6:canAccess=Boolean(Number(r.isReadableFileAtPath(t)))&&Boolean(Number(r.isWritableFileAtPath(t)));break;case 7:canAccess=Boolean(Number(r.isReadableFileAtPath(t)))&&Boolean(Number(r.isWritableFileAtPath(t)))&&Boolean(Number(r.isExecutableFileAtPath(t)))}if(!canAccess)throw new Error("Can't access "+String(t))},e.exports.appendFile=c("appendFile"),e.exports.appendFileSync=function(t,n,a){if(!e.exports.existsSync(t))return e.exports.writeFileSync(t,n,a);var i=NSFileHandle.fileHandleForWritingAtPath(t);i.seekToEndOfFile();var o=l(a,"utf8"),s=r.from(n,"NSData"===o||"buffer"===o?void 0:o).toNSData();i.writeData(s)},e.exports.chmod=c("chmod"),e.exports.chmodSync=function(e,t){var n=MOPointer.alloc().init();if(NSFileManager.defaultManager().setAttributes_ofItemAtPath_error({NSFilePosixPermissions:t},e,n),null!==n.value())throw s(e,void 0,n.value())},e.exports.chown=c("chown"),e.exports.chownSync=c("chownSync"),e.exports.close=c("close"),e.exports.closeSync=c("closeSync"),e.exports.copyFile=c("copyFile"),e.exports.copyFileSync=function(e,t,n){var r=MOPointer.alloc().init();if(NSFileManager.defaultManager().copyItemAtPath_toPath_error(e,t,r),null!==r.value())throw s(e,!1,r.value())},e.exports.createReadStream=c("createReadStream"),e.exports.createWriteStream=c("createWriteStream"),e.exports.exists=c("exists"),e.exports.existsSync=function(e){var t=NSFileManager.defaultManager();return Boolean(Number(t.fileExistsAtPath(e)))},e.exports.fchmod=c("fchmod"),e.exports.fchmodSync=c("fchmodSync"),e.exports.fchown=c("fchown"),e.exports.fchownSync=c("fchownSync"),e.exports.fdatasync=c("fdatasync"),e.exports.fdatasyncSync=c("fdatasyncSync"),e.exports.fstat=c("fstat"),e.exports.fstatSync=c("fstatSync"),e.exports.fsync=c("fsync"),e.exports.fsyncSync=c("fsyncSync"),e.exports.ftruncate=c("ftruncate"),e.exports.ftruncateSync=c("ftruncateSync"),e.exports.futimes=c("futimes"),e.exports.futimesSync=c("futimesSync"),e.exports.lchmod=c("lchmod"),e.exports.lchmodSync=c("lchmodSync"),e.exports.lchown=c("lchown"),e.exports.lchownSync=c("lchownSync"),e.exports.link=c("link"),e.exports.linkSync=function(e,t){var n=MOPointer.alloc().init();if(NSFileManager.defaultManager().linkItemAtPath_toPath_error(e,t,n),null!==n.value())throw s(e,void 0,n.value())},e.exports.lstat=c("lstat"),e.exports.lstatSync=function(e){var t=MOPointer.alloc().init(),n=NSFileManager.defaultManager().attributesOfItemAtPath_error(e,t);if(null!==t.value())throw s(e,void 0,t.value());return i(n)},e.exports.mkdir=c("mkdir"),e.exports.mkdirSync=function(e,t){var n=511,r=!1;t&&t.mode&&(n=t.mode),t&&t.recursive&&(r=t.recursive),"number"==typeof t&&(n=t);var a=MOPointer.alloc().init();if(NSFileManager.defaultManager().createDirectoryAtPath_withIntermediateDirectories_attributes_error(e,r,{NSFilePosixPermissions:n},a),null!==a.value())throw new Error(a.value())},e.exports.mkdtemp=c("mkdtemp"),e.exports.mkdtempSync=function(t){var n=t+function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<6;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}();return e.exports.mkdirSync(n),n},e.exports.open=c("open"),e.exports.openSync=c("openSync"),e.exports.read=c("read"),e.exports.readdir=c("readdir"),e.exports.readdirSync=function(e,t){for(var n=l(t,"utf8"),a=NSFileManager.defaultManager().subpathsAtPath(e),i=[],o=0;o<a.length;o++){var s=a[o];i.push("buffer"===n?r.from(s):String(s))}return i},e.exports.readFile=c("readFile"),e.exports.readFileSync=function(e,t){var n=l(t,"buffer"),a=NSFileManager.defaultManager().contentsAtPath(e);if(!a)throw s(e,!1);var i=r.from(a);return"buffer"===n?i:"NSData"===n?i.toNSData():i.toString(n)},e.exports.readlink=c("readlink"),e.exports.readlinkSync=function(e){var t=MOPointer.alloc().init(),n=NSFileManager.defaultManager().destinationOfSymbolicLinkAtPath_error(e,t);if(null!==t.value())throw s(e,void 0,t.value());return String(n)},e.exports.readSync=c("readSync"),e.exports.realpath=c("realpath"),e.exports.realpath.native=c("realpath.native"),e.exports.realpathSync=function(e){return String(NSString.stringWithString(e).stringByResolvingSymlinksInPath())},e.exports.realpathSync.native=c("realpathSync.native"),e.exports.rename=c("rename"),e.exports.renameSync=function(e,t){var n=MOPointer.alloc().init(),r=NSFileManager.defaultManager();r.moveItemAtPath_toPath_error(e,t,n);var a=n.value();if(null!==a){if("NSCocoaErrorDomain"!==String(a.domain())||516!==Number(a.code()))throw s(e,void 0,a);var i=MOPointer.alloc().init();if(r.replaceItemAtURL_withItemAtURL_backupItemName_options_resultingItemURL_error(NSURL.fileURLWithPath(t),NSURL.fileURLWithPath(e),null,NSFileManagerItemReplacementUsingNewMetadataOnly,null,i),null!==i.value())throw s(e,void 0,i.value())}},e.exports.rmdir=c("rmdir"),e.exports.rmdirSync=function(t){var n=MOPointer.alloc().init(),r=NSFileManager.defaultManager();if(!e.exports.lstatSync(t).isDirectory())throw o("ENOTDIR",{path:t,syscall:"rmdir"});if(r.removeItemAtPath_error(t,n),null!==n.value())throw s(t,!0,n.value(),"rmdir")},e.exports.stat=c("stat"),e.exports.statSync=function(t){return e.exports.lstatSync(e.exports.realpathSync(t))},e.exports.symlink=c("symlink"),e.exports.symlinkSync=function(e,t){var n=MOPointer.alloc().init();NSFileManager.defaultManager().createSymbolicLinkAtPath_withDestinationPath_error(t,e,n);if(null!==n.value())throw new Error(n.value())},e.exports.truncate=c("truncate"),e.exports.truncateSync=function(e,t){var n=NSFileHandle.fileHandleForUpdatingAtPath(sFilePath);n.truncateFileAtOffset(t||0),n.closeFile()},e.exports.unlink=c("unlink"),e.exports.unlinkSync=function(t){var n=MOPointer.alloc().init(),r=NSFileManager.defaultManager();if(e.exports.lstatSync(t).isDirectory())throw o("EPERM",{path:t,syscall:"unlink"});r.removeItemAtPath_error(t,n);if(null!==n.value())throw s(t,!1,n.value())},e.exports.unwatchFile=c("unwatchFile"),e.exports.utimes=c("utimes"),e.exports.utimesSync=function(e,t,n){var r=MOPointer.alloc().init();NSFileManager.defaultManager().setAttributes_ofItemAtPath_error({NSFileModificationDate:t},e,r);if(null!==r.value())throw s(e,void 0,r.value())},e.exports.watch=c("watch"),e.exports.watchFile=c("watchFile"),e.exports.write=c("write"),e.exports.writeFile=c("writeFile"),e.exports.writeFileSync=function(e,t,n){var a=l(n,"utf8");r.from(t,"NSData"===a||"buffer"===a?void 0:a).toNSData().writeToFile_atomically(e,!0)},e.exports.writeSync=c("writeSync")},function(e,t){e.exports=require("buffer")},function(e,t,n){e.exports.parseStat=function(e){return{dev:String(e.NSFileDeviceIdentifier),mode:e.NSFileType|e.NSFilePosixPermissions,nlink:Number(e.NSFileReferenceCount),uid:String(e.NSFileOwnerAccountID),gid:String(e.NSFileGroupOwnerAccountID),size:Number(e.NSFileSize),atimeMs:1e3*Number(e.NSFileModificationDate.timeIntervalSince1970()),mtimeMs:1e3*Number(e.NSFileModificationDate.timeIntervalSince1970()),ctimeMs:1e3*Number(e.NSFileModificationDate.timeIntervalSince1970()),birthtimeMs:1e3*Number(e.NSFileCreationDate.timeIntervalSince1970()),atime:new Date(1e3*Number(e.NSFileModificationDate.timeIntervalSince1970())+.5),mtime:new Date(1e3*Number(e.NSFileModificationDate.timeIntervalSince1970())+.5),ctime:new Date(1e3*Number(e.NSFileModificationDate.timeIntervalSince1970())+.5),birthtime:new Date(1e3*Number(e.NSFileCreationDate.timeIntervalSince1970())+.5),isBlockDevice:function(){return e.NSFileType===NSFileTypeBlockSpecial},isCharacterDevice:function(){return e.NSFileType===NSFileTypeCharacterSpecial},isDirectory:function(){return e.NSFileType===NSFileTypeDirectory},isFIFO:function(){return!1},isFile:function(){return e.NSFileType===NSFileTypeRegular},isSocket:function(){return e.NSFileType===NSFileTypeSocket},isSymbolicLink:function(){return e.NSFileType===NSFileTypeSymbolicLink}}};var r={EPERM:{message:"operation not permitted",errno:-1},ENOENT:{message:"no such file or directory",errno:-2},EACCES:{message:"permission denied",errno:-13},ENOTDIR:{message:"not a directory",errno:-20},EISDIR:{message:"illegal operation on a directory",errno:-21}};function a(e,t){var n=new Error(e+": "+r[e].message+", "+(t.syscall||"")+(t.path?" '"+t.path+"'":""));return Object.keys(t).forEach((function(e){n[e]=t[e]})),n.code=e,n.errno=r[e].errno,n}e.exports.fsError=a,e.exports.fsErrorForPath=function(e,t,r,i){var o=NSFileManager.defaultManager();if(!o.fileExistsAtPath(e))return a("ENOENT",{path:e,syscall:i||"open"});if(!o.isReadableFileAtPath(e))return a("EACCES",{path:e,syscall:i||"open"});if(void 0!==t){var s=n(1).lstatSync(e).isDirectory();if(s&&!t)return a("EISDIR",{path:e,syscall:i||"read"});if(!s&&t)return a("ENOTDIR",{path:e,syscall:i||"read"})}return new Error(r||"Unknown error while manipulating "+e)},e.exports.encodingFromOptions=function(e,t){return e&&e.encoding?String(e.encoding):e?String(e):t},e.exports.NOT_IMPLEMENTED=function(e){return function(){throw new Error("fs."+e+" is not implemented yet. If you feel like implementing it, any contribution will be gladly accepted on https://github.com/skpm/fs")}}},function(e,t){e.exports=require("os")},function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1),i=n(4).homedir(),o=n(0);t.default=function(e){var t,n,s,l=o.getSelectedDocument(),c=l.selectedLayers,u=l.selectedPage.name,p=[],d=[],f={scales:"2",formats:"png",output:"".concat(i,"/Downloads/").concat(u,"-Slideshow"),overwriting:!0};if(0!==c.length){if(c.length>=1){p=c.layers.map((function(e){if(void 0!==e.getParentArtboard()&&(e=e.getParentArtboard()),"Artboard"===e.type)return{name:encodeURIComponent(e.name),id:e.id,backgroundColor:e.background.color,bounds:e.frame,object:e}})).filter((function(e){return!(d.indexOf(e.id)>-1)&&d.push(e.id)})),e.document.showMessage("Creating preview for ".concat(p.length," artboards."));var m=function(e,t,n){var i=[];e.map((function(e){r.export(e.object,t);var n={bounds:e.bounds,path:e.name+"."+t.formats};t.scales>1&&(n.path=e.name+"@"+t.scales+"x."+t.formats),i.push(n)}));var o="".concat(t.output,"/index.html");console.log(o),console.log(i);var s="<!DOCTYPE html>\n  <html>\n  <head>\n      <title>".concat(n,' Slides</title>\n      <style type="text/css">\n      body {\n          margin: 0;\n          padding: 0;\n          font-family: -apple-system, BlinkMacSystemFont, sans-serif;\n          font-size: 16px;\n          color: #fff;\n      }\n\n      .slideshow {\n          margin: 0;\n          padding: 0;\n      }\n\n      .page {\n          max-width: 100%;\n          max-height: 100%;\n          overflow: scroll;\n          position: absolute;\n          display: none;\n      }\n\n      .page.show {\n          display: block;\n      }\n\n      .alert {\n          position: absolute;\n          width: 100%;\n          text-align: center;\n      }\n\n      .alert p {\n          width: 200px;\n          height: 48px;\n          line-height: 48px;\n          background: #000000e6;\n          border: solid 1px #ffffff20;\n          margin: auto;\n          margin-top: -50px;\n          display: none;\n      }\n\n      .alert p.show {\n          transform: translateY(49px);\n          display: block;\n      }\n      </style>\n  </head>\n  <body>\n      <div class="slideshow">\n          ').concat(i.map((function(e){return'<section class="page"><img src="'+e.path+'" width="'+e.bounds.width+'px" height="'+e.bounds.height+'px"></section>'})).join("\n"),'\n      </div>\n      <div class="alert">\n          <p class="reach-end">Reach the end</p>\n          <p class="reach-top">Reach the top</p>\n      </div>\n      <script>\n      document.addEventListener("keydown", switchSlide);\n      const slides = document.getElementsByClassName("page");\n      const alertEnd = document.getElementsByClassName("reach-end");\n      const alertTop = document.getElementsByClassName("reach-top");\n\n      let pageNum = 0;\n      slides[0].classList.add("show");\n\n      function hideSlide(pageNum) {\n          slides[pageNum].classList.remove("show");\n      }\n\n      function showSlide(pageNum) {\n          slides[pageNum].classList.add("show");\n      }\n\n      function nextSlide() {\n          hideSlide(pageNum);\n          pageNum = pageNum + 1;\n          showSlide(pageNum);\n      }\n\n      function prevSlide() {\n          hideSlide(pageNum);\n          pageNum = pageNum - 1;\n          showSlide(pageNum);\n      }\n\n      function switchSlide(event) {\n          let key = event.keyCode;\n          // console.log(key)\n\n          // Press key Arrow Right, K, Space switch to the next slide\n          if ((key == 39) | (key == 32) | (key == 75)) {\n              console.log("Next Slide");\n              event.preventDefault();\n              if (pageNum < slides.length - 1) {\n                  nextSlide();\n              } else {\n                  console.log("Reach End");\n                  alertTop[0].classList.remove("show");\n                  alertEnd[0].classList.add("show");\n                  setTimeout(function() {\n                      alertEnd[0].classList.remove("show");\n                  }, 2000);\n              }\n          }\n\n          // Press Arrow Left, J switch to the previous slide\n          if ((key == 37) | (key == 74)) {\n              console.log("Prev Slide");\n              event.preventDefault();\n              if (pageNum > 0) {\n                  prevSlide();\n              } else {\n                  console.log("Reach Top");\n                  alertEnd[0].classList.remove("show");\n                  alertTop[0].classList.add("show");\n                  setTimeout(function() {\n                      alertTop[0].classList.remove("show");\n                  }, 2000);\n              }\n          }\n      }\n      <\/script>\n  </body>\n  </html>');return a.writeFileSync(o,s),console.log(s),o}(p,f,u);return t="/usr/bin/open",n=[m],(s=NSTask.alloc().init()).setLaunchPath_(t),s.arguments=n,s.launch(),s.waitUntilExit(),void s.terminationStatus()}}else e.document.showMessage("⚠️ Please select at least one artboard or layer.")}}]);if("default"===e&&"function"==typeof n)n(t);else{if("function"!=typeof n[e])throw new Error('Missing export named "'+e+'". Your command should contain something like `export function " + key +"() {}`.');n[e](t)}}catch(r){if("undefined"==typeof process||!process.listenerCount||!process.listenerCount("uncaughtException"))throw r;process.emit("uncaughtException",r,"uncaughtException")}}globalThis.onRun=__skpm_run.bind(this,"default");